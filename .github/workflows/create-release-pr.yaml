name: Create Release PR

on:
  push:
    branches:
      - develop

jobs:
  create-release-pr:
    name: Create Release PR
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      - name: Check if PR exists
        env:
          GH_TOKEN: ${{ github.token }}
        run: |
          on_error() {
            echo "PR create attempt failed, assuming PR already exists."
            exit 0
          }

          NEWLINE=$'\n'
          trap "on_error" INT TERM ERR
          gh pr create --title "Release" --body "If this change should result in new package versions please add a changeset before merging. You can do so by clicking the maintainers link provided by changeset-bot below.${NEWLINE}${NEWLINE}Please note that changeset-bot appears to produce inconsistent / incorrect results with the latest version of changesets when run locally. Be sure to check that it is correctly mentioning the changed packages in the referenced link, or produce the changeset locally \`yarn changeset\` and push it to the branch."
